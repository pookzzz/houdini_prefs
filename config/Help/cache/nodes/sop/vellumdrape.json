{"type": "root", "attrs": {"type": "node", "context": "sop", "internal": "vellumdrape", "icon": "SHELF/vellum_cloth", "since": "17.0", "version": null, "namespace": null}, "body": [{"level": 0, "type": "title", "indent": 0, "text": ["Vellum Drape"], "extent": [98, 115]}, {"type": "summary", "indent": 0, "text": ["Vellum solver setup to pre-roll fabric to drape over characters."], "extent": [115, 188]}, {"type": "para", "indent": 0, "text": ["When stitching together pieces of flat cloth it is useful to do so\nwithin a simulation rather than through modeling operations.   The\nVellum Drape SOP provides a sandbox simulation designed around moving\nstitched points together slowly before fusing them with welds."], "extent": [188, 456]}, {"level": 1, "id": "parameters", "container": true, "type": "parameters_section", "indent": 0, "role": "section", "extent": [456, 468], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Reset Simulation"], "extent": [1408, 1427], "body": [{"type": "para", "indent": 4, "text": ["Clears the entire simulation cache."], "extent": [1448, 1489]}], "container": true, "attrs": {"id": "resimulate"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Freeze"], "extent": [504, 512], "body": [{"type": "para", "indent": 4, "text": ["Rather than outputting the current frame, output the provided\n    freeze frame.   This is useful for setting up the pre-roll\n    for a sequence of drape operations."], "extent": [531, 702]}], "container": true, "attrs": {"id": "dofreeze"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Freeze at Frame"], "extent": [702, 719], "body": [{"type": "para", "indent": 4, "text": ["Which frame to pre-roll to.  This is an absolute frame number,\n    so should be some number of frames after the start frame of\n    your scene."], "extent": [741, 890]}], "container": true, "attrs": {"id": "freezeframe"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Load from Disk"], "extent": [890, 906], "body": [{"type": "para", "indent": 4, "text": ["After a drape is completed, it can be loaded from file rather\n    than recomputed."], "extent": [929, 1018]}], "container": true, "attrs": {"id": "loadfromdisk"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Geometry File"], "extent": [1018, 1033], "body": [{"type": "para", "indent": 4, "text": ["The file to save the drape to.  A pair of packed primitives will\n    be saved as both the constraint and surface geometry are required."], "extent": [1048, 1189]}, {"type": "para", "indent": 4, "text": ["Note that this is not a file sequence as a drape is expected to\n    be the final configuration."], "extent": [1189, 1291]}], "container": true, "attrs": {"id": "file"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Reload Geometry"], "extent": [1291, 1308], "body": [{"type": "para", "indent": 4, "text": ["Force the geometry to reload if it updated from some external process."], "extent": [1325, 1402]}], "container": true, "attrs": {"id": "reload"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Save to Disk"], "extent": [1402, 1416], "body": [{"type": "para", "indent": 4, "text": ["Save the current drape results to the given file."], "extent": [1434, 1490]}], "container": true, "attrs": {"id": "execute"}, "role": "item"}], "container": true, "role": "item_group"}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Draping"], "extent": [1490, 1504], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Inflate Collisions"], "extent": [1504, 1525], "body": [{"type": "para", "indent": 4, "text": ["The initial pose of the cloth may be intersecting the collision\n    object.  This may happen if replacing a low res proxy collider\n    with a higher resolution object, for example.  In this case by\n    slightly deflating the collision object and inflating it over time\n    you can recover a non-self intersecting drape."], "extent": [1555, 1881]}], "container": true, "attrs": {"id": "collision_doinflate"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Initial Deflation"], "extent": [1881, 1900], "body": [{"type": "para", "indent": 4, "text": ["The distance to peak the collision geometry inwards at the start frame."], "extent": [1928, 2006]}], "container": true, "attrs": {"id": "collision_deflate"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Final Inflation"], "extent": [2006, 2023], "body": [{"type": "para", "indent": 4, "text": ["The distance to peak the collision geometry outwards at the final frame."], "extent": [2051, 2130]}], "container": true, "attrs": {"id": "collision_inflate"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Inflation Frames"], "extent": [2130, 2148], "body": [{"type": "para", "indent": 4, "text": ["The number of frames to spread the inflation process over."], "extent": [2175, 2240]}], "container": true, "attrs": {"id": "collision_frames"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Weld Additional Seams"], "extent": [2240, 2263], "body": [{"type": "para", "indent": 4, "text": ["Seams of cloth can be welded in a two step process.  For the first\n    stage, soft springs will pull the points together.  No gravity\n    will be present to allow the cloth to flow over the body.  In\n    the second stage, the points are welded together, immediately\n    closing the seam.  Gravity is then enabled to let the cloth\n    fall down."], "extent": [2280, 2631]}], "container": true, "attrs": {"id": "doweld"}, "role": "item"}], "container": true, "role": "item_group"}, {"level": 3, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Weld Seams"], "extent": [2631, 2650], "body": []}, {"level": 3, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Seams"], "extent": [2650, 2665], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Enable"], "extent": [2665, 2674], "body": [{"type": "para", "indent": 4, "text": ["Enable this particular seam."], "extent": [2697, 2732]}], "container": true, "attrs": {"id": "seam_enable#"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Group"], "extent": [2732, 2739], "body": [{"type": "para", "indent": 4, "text": ["Point group to use as the first half of the seam.  This should be an\n    ordered point group to ensure points match with the target."], "extent": [2761, 2899]}, {"type": "note_group", "body": [{"type": "note", "indent": 4, "role": "item", "extent": [2899, 2909], "body": [{"type": "para", "indent": 8, "text": ["Specifying more than one named ordered group will result in an unordered list of points."], "extent": [2909, 3008]}], "container": true}], "container": true, "role": "item_group"}], "container": true, "attrs": {"id": "seam_group#"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Target Group"], "extent": [3008, 3022], "body": [{"type": "para", "indent": 4, "text": ["Point group to use as the second half of the seam.  Each point\n    of the group will be joined to the target in the point group order,\n    so ordered point groups should be used."], "extent": [3045, 3229]}, {"type": "note_group", "body": [{"type": "note", "indent": 4, "role": "item", "extent": [3229, 3239], "body": [{"type": "para", "indent": 8, "text": ["Using multiple named ordered point groups may not match as expected. Instead, use one seam per named group."], "extent": [3239, 3356]}], "container": true}], "container": true, "role": "item_group"}], "container": true, "attrs": {"id": "seam_target#"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Cycle"], "extent": [3356, 3363], "body": [{"type": "para", "indent": 4, "text": ["If the point groups do not line up, cycle the start point this number\n    of points."], "extent": [3385, 3476]}], "container": true, "attrs": {"id": "seam_cycle#"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Reverse"], "extent": [3476, 3485], "body": [{"type": "para", "indent": 4, "text": ["If one of the point groups has reversed order, this will let you reverse\n    the order of the seaming.  This is useful when procedurally generated\n    seams are pointed the wrong way."], "extent": [3509, 3699]}], "container": true, "attrs": {"id": "seam_reverse#"}, "role": "item"}], "container": true, "role": "item_group"}]}, {"level": 3, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Weld Properties"], "extent": [3699, 3723], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Welding Frame Delay"], "extent": [3723, 3745], "body": [{"type": "para", "indent": 4, "text": ["The number of frames to use soft springs before welding the points\n    together."], "extent": [3765, 3852]}], "container": true, "attrs": {"id": "weldframe"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Attraction Stiffness"], "extent": [3852, 3874], "body": [{"type": "para", "indent": 4, "text": ["The strength of the springs."], "extent": [3901, 3936]}], "container": true, "attrs": {"id": "stretchstiffness"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Add Bend across Welds"], "extent": [3936, 3959], "body": [{"type": "para", "indent": 4, "text": ["When the points are welded, bend constraints are also added to make\n    it act like a single flat piece of cloth.  Without this, the seam\n    can cusp and bend freely."], "extent": [3978, 4151]}, {"type": "para", "indent": 4, "text": ["The bend stiffness is averaged from the surrounding bend constraints."], "extent": [4151, 4227]}], "container": true, "attrs": {"id": "bendweld"}, "role": "item"}], "container": true, "role": "item_group"}]}]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Solver"], "extent": [4227, 4240], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Time Scale"], "extent": [2443, 2455], "body": [{"type": "para", "indent": 4, "text": ["Scales the effective time of the Vellum solve.  This can be used to\n    create bullet-time like effects where the physics of the Vellum\n    solver run at a different rate than the Houdini playbar.  A\n    value of 2 will cause cloth to fall twice as fast, and 0.1\n    will slow it to a tenth the speed."], "extent": [2475, 2782]}], "container": true, "attrs": {"id": "timescale"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Substeps"], "extent": [3184, 3194], "body": [{"type": "para", "indent": 4, "text": ["Each frame will be broken into this number of substeps.  Additional\n    substeps are required for fast moving collisions or sudden forces."], "extent": [3213, 3357]}, {"type": "para", "indent": 4, "text": ["The default substeps can be very aggressive, usually if the\n    Vellum solver is too stretchy, raising substeps to 2 or 5 is\n    a good first start."], "extent": [3357, 3511]}], "container": true, "attrs": {"id": "substeps"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Constraint Iterations"], "extent": [3511, 3534], "body": [{"type": "para", "indent": 4, "text": ["Within each substep, this number of passes will be taken by the\n    constraint enforcement operations.   Stiff constraints can\n    require more iterations to converge.  A good starting point\n    is the diameter of the geometry - the number of edges between\n    the farthest points."], "extent": [3550, 3838]}], "container": true, "attrs": {"id": "niter"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Smoothing Iterations"], "extent": [3838, 3860], "body": [{"type": "para", "indent": 4, "text": ["The default constraint iterations use a Gauss-Seidel approach that\n    is fast to converge.  However, if it doesn\u2019t fully converge due to\n    too high stiffness, or impossible configurations, it will leave the error\n    as bad looking triangles.  The smoothing iterations use a Jacobi\n    approach which is slower to converge but leaves error spread out\n    in a more attractive fashion.  The default of ten passes helps\n    smooth out error, but might need to be increased if the overall\n    ", {"type": "ui", "text": ["Constraint Iterations"]}, " is very high."], "extent": [3881, 4419]}], "container": true, "attrs": {"id": "smoothiter"}, "role": "item"}], "container": true, "role": "item_group"}, {"level": 3, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Collisions"], "extent": [4370, 4389], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Enable Collisions"], "extent": [4438, 4458], "body": [{"type": "para", "indent": 4, "text": ["Controls if any collision detection is done at all."], "extent": [4485, 4542]}], "container": true, "attrs": {"id": "enablecollisions"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Self Collisions"], "extent": [4542, 4559], "body": [{"type": "para", "indent": 4, "text": ["Controls if self collisions are detected."], "extent": [4586, 4633]}], "container": true, "attrs": {"id": "doselfcollisions"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Ground Plane"], "extent": [4633, 4647], "body": [{"type": "para", "indent": 4, "text": ["Adds a ground plane to the simulation.  The ground plane will\n    be visualized with a blue grid."], "extent": [4667, 4770]}], "container": true, "attrs": {"id": "useground"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Ground Position"], "extent": [4770, 4787], "body": [{"type": "para", "indent": 4, "text": ["Location of the center of the ground plane."], "extent": [4807, 4857]}], "container": true, "attrs": {"id": "groundpos"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Collision Passes"], "extent": [4857, 4875], "body": [{"type": "para", "indent": 4, "text": ["Number of collision detection passes to perform.  These are interleaved\n    between the constraint iterations.  Since collision is expensive, it is\n    best to minimize this.   But frequent interleaving helps avoid tent-poling\n    effects where a small collider is fighting with the no-stretch constraints.\n    In practice we find 10 to be correct for most situations, and substeps\n    often being a better solution to increase quality."], "extent": [4900, 5343]}], "container": true, "attrs": {"id": "collisionsiter"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Post Collision Passes"], "extent": [5343, 5366], "body": [{"type": "para", "indent": 4, "text": ["After all constraints are performed, a final round of collision detection\n    is done.   Collisions are often the most noticeable failure mode, and it\n    is ideal if the next frame can start with non-intersecting geometry.\n    Thus a final cleanup pass can achieve these requirements.   We have\n    found that ", {"type": "q", "text": ["number of stacked layers + 2"]}, " is a good estimate for this\n    number.   This allows the effect of the underlying collider to ripple\n    through the stacked layers fully."], "extent": [5394, 5881]}], "container": true, "attrs": {"id": "postcollisioniter"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Polish Passes"], "extent": [5881, 5896], "body": [{"type": "para", "indent": 4, "text": ["In any collision pass, any colliding pair may not be fully resolved.   This\n    number of additional collider-pair passes will be run until they are\n    resolved.  Since these are only performed on active colliders (and no new\n    collision search is done) this is very cheap."], "extent": [5920, 6203]}], "container": true, "attrs": {"id": "resolveallmax"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Layer Shock"], "extent": [6203, 6216], "body": [{"type": "para", "indent": 4, "text": ["The ", {"type": "code", "text": ["layer"]}, " integer point attribute is used to flag point as belonging\n    to different layers of cloth.  Higher numbers refer to higher layers.\n    Layer Shock will make lower layers this many times heavier during collision\n    evaluation, ensuring the higher layers will move out of their way.  The\n    rest of the dynamics are unaffected by this, and the difference is fixed\n    regardless of the number of layers between the two.  This can be thought\n    of as a way to dial between one-way layering of sims and fully coupled\n    sims."], "extent": [6237, 6782]}], "container": true, "attrs": {"id": "layershock"}, "role": "item"}], "container": true, "role": "item_group"}]}]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Forces"], "extent": [4687, 4700], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Gravity"], "extent": [6795, 6805], "body": [{"type": "para", "indent": 4, "text": ["Uniform gravity force to apply."], "extent": [6823, 6861]}], "container": true, "attrs": {"id": "gravity"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Air Drag"], "extent": [4733, 4743], "body": [{"type": "para", "indent": 4, "text": ["Amount of air resistance bringing the cloth to a standstill."], "extent": [4761, 4827]}], "container": true, "attrs": {"id": "airdrag"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Velocity Damping"], "extent": [9186, 9204], "body": [{"type": "para", "indent": 4, "text": ["A more brute force approach to reducing dynamic velocity. The velocity is scaled directly by this amount, causing sudden movements to be quickly damped."], "extent": [9225, 9383]}], "container": true, "attrs": {"id": "veldamping"}, "role": "item"}], "container": true, "role": "item_group"}, {"level": 3, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Friction"], "extent": [4862, 4879], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Static Threshold"], "extent": [9400, 9419], "body": [{"type": "para", "indent": 4, "text": ["A threshold at which to apply full friction.  When the ratio of the tangential velocity and the normal impulse is less than this, the tangential velocity will be fully eliminated through friction.  This is roughly tan() of the slope angle that will allow sliding under gravity."], "extent": [9446, 9730]}], "container": true, "attrs": {"id": "static_threshold"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Dynamic Scale"], "extent": [9730, 9745], "body": [{"type": "para", "indent": 4, "text": ["If the static threshold fails, this controls what percentage the tangential velocity will be reduced in the dynamic friction case."], "extent": [9769, 9905]}], "container": true, "attrs": {"id": "dynamic_scale"}, "role": "item"}], "container": true, "role": "item_group"}]}]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Simulation"], "extent": [4958, 4975], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Cache Enabled"], "extent": [10497, 10513], "body": [{"type": "para", "indent": 4, "text": ["Controls if the simulation is cached to memory."], "extent": [10536, 10589]}], "container": true, "attrs": {"id": "cacheenabled"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Cache Memory (MB)"], "extent": [10589, 10608], "body": [{"type": "para", "indent": 4, "text": ["Maximum size of the memory cache."], "extent": [10631, 10670]}], "container": true, "attrs": {"id": "cachemaxsize"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Start Frame"], "extent": [1489, 1502], "body": [{"type": "para", "indent": 4, "text": ["What frame on the Houdini playbar that the simulation should begin at."], "extent": [1523, 1599]}], "container": true, "attrs": {"id": "startframe"}, "role": "item"}], "container": true, "role": "item_group"}]}], "text": "Parameters"}, {"level": 1, "id": "related", "container": true, "type": "related_section", "indent": 0, "role": "section", "extent": [5083, 5092], "body": [{"type": "bullet_group", "body": [{"blevel": 6, "type": "bullet", "indent": 4, "text": [{"scheme": "Node", "value": "/nodes/sop/vellumsolver", "type": "link", "text": "", "fullpath": "/nodes/sop/vellumsolver.html"}], "extent": [5092, 5122]}, {"blevel": 6, "type": "bullet", "indent": 4, "text": [{"scheme": "Node", "value": "/nodes/sop/vellumconstraints", "type": "link", "text": "", "fullpath": "/nodes/sop/vellumconstraints.html"}], "extent": [5122, 5157]}, {"blevel": 6, "type": "bullet", "indent": 4, "text": [{"scheme": "Node", "value": "/nodes/sop/vellumconstraints_grain", "type": "link", "text": "", "fullpath": "/nodes/sop/vellumconstraints_grain.html"}], "extent": [5157, 5198]}, {"blevel": 6, "type": "bullet", "indent": 4, "text": [{"scheme": "Node", "value": "/nodes/sop/vellumio", "type": "link", "text": "", "fullpath": "/nodes/sop/vellumio.html"}], "extent": [5198, 5225]}], "container": true}], "text": "Related"}], "title": ["Vellum Drape"], "summary": ["Vellum solver setup to pre-roll fabric to drape over characters."], "included": ["/nodes/dop/popCommonParms", "/nodes/dop/popattribblur", "/nodes/dop/popmaskfromshadow", "/nodes/dop/popwindshadow", "/nodes/dop/standard_fluid_grains_parms", "/nodes/dop/standard_pop_parms", "/nodes/sop/_vellum_common", "/nodes/sop/attribblur", "/nodes/sop/vellumsolver"]}