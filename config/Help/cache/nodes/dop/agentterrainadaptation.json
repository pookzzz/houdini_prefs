{"type": "root", "attrs": {"type": "node", "context": "dop", "internal": "agentterrainadaptation", "icon": "CROWDS/agentterrainadaptation", "tags": "crowds", "version": "3.0", "since": "15.5", "namespace": null}, "body": [{"level": 0, "type": "title", "indent": 0, "text": ["Agent Terrain Adaptation"], "extent": [139, 168]}, {"type": "summary", "indent": 0, "text": ["Adapts the legs of an agent to conform to terrain and prevent the feet from sliding."], "extent": [168, 261]}, {"type": "para", "indent": 0, "text": ["This node is used as part of a crowd simulation to modify the transforms of\nagent leg bones to avoid intersection with terrain and prevent the feet from sliding."], "extent": [261, 424]}, {"level": 1, "id": "parameters", "container": true, "type": "parameters_section", "indent": 0, "role": "section", "extent": [424, 436], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Activation"], "extent": [280, 293], "body": [{"type": "para", "indent": 4, "text": [{"type": "code", "text": ["1"]}, " activates the node. ", {"type": "code", "text": ["0"]}, " deactivates the node."], "extent": [313, 368]}], "container": true, "attrs": {"id": "enable"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Group"], "extent": [368, 375], "body": [{"type": "para", "indent": 4, "text": ["The group of agents that this node should affect."], "extent": [394, 449]}], "container": true, "attrs": {"id": "partgroup"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Source"], "extent": [544, 552], "body": [{"type": "para", "indent": 4, "text": ["Source for the terrain object (SOP path or DOP object)."], "extent": [488, 549]}, {"type": "dt_group", "body": [{"type": "dt", "indent": 4, "text": ["SOP"], "extent": [549, 558], "body": [{"type": "para", "indent": 8, "text": ["Use the SOP specified in the ", {"type": "ui", "text": ["SOP Path"]}, " parameter."], "extent": [558, 620]}], "container": true}, {"type": "dt", "indent": 4, "text": ["DOP Data"], "extent": [620, 634], "body": [{"type": "para", "indent": 8, "text": ["Use the DOP specified in the ", {"type": "ui", "text": ["Terrain Object"]}, " parameter."], "extent": [634, 702]}], "container": true}, {"type": "dt", "indent": 4, "text": ["First Context Geometry"], "extent": [702, 730], "body": [{"type": "para", "indent": 8, "text": ["Use the SOP connected to the DOP network\u2019s first input."], "extent": [730, 795]}], "container": true}, {"type": "dt", "indent": 4, "text": ["Second Context Geometry"], "extent": [795, 824], "body": [{"type": "para", "indent": 8, "text": ["Use the SOP connected to the DOP network\u2019s second input."], "extent": [824, 890]}], "container": true}, {"type": "dt", "indent": 4, "text": ["Third Context Geometry"], "extent": [890, 918], "body": [{"type": "para", "indent": 8, "text": ["Use the SOP connected to the DOP network\u2019s third input."], "extent": [918, 983]}], "container": true}, {"type": "dt", "indent": 4, "text": ["Fourth Context Geometry"], "extent": [983, 1012], "body": [{"type": "para", "indent": 8, "text": ["Use the SOP connected to the DOP network\u2019s fourth input."], "extent": [1012, 1078]}], "container": true}], "container": true}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["SOP Path"], "extent": [1078, 1088], "body": [{"type": "para", "indent": 4, "text": ["The path to the SOP (when the terrain source is set to ", {"type": "ui", "text": ["SOP"]}, ")."], "extent": [1112, 1182]}], "container": true, "attrs": {"id": "terrainsoppath"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Terrain Object"], "extent": [1182, 1198], "body": [{"type": "para", "indent": 4, "text": ["The DOP object to use as the terrain geometry. This can also be specified as an object/data path for using specific geometry data attached to an object. For example, ", {"type": "code", "text": ["popobject/Geometry"]}, ". "], "extent": [1221, 1415]}, {"type": "para", "indent": 4, "text": ["This parameter is only available when the terrain source is set to ", {"type": "ui", "text": ["DOP Data"]}, "."], "extent": [1415, 1501]}], "container": true, "attrs": {"id": "terrainobject"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Terrain Group"], "extent": [1501, 1516], "body": [{"type": "para", "indent": 4, "text": ["The primitives in the terrain geometry to be used for ray intersections."], "extent": [1538, 1616]}], "container": true, "attrs": {"id": "terraingroup"}, "role": "item"}], "container": true, "role": "item_group"}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Terrain Adaptation"], "extent": [785, 810], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Enable Foot Locking"], "extent": [810, 832], "body": [{"type": "para", "indent": 4, "text": ["When turned on, prevents the ankle and toe from sliding when the foot should be planted.\n    The channels specified on the ", {"scheme": "Node", "value": "/nodes/sop/agentprep", "type": "link", "text": ["Agent Prep SOP"], "fullpath": "/nodes/sop/agentprep.html"}, " are used to determine when the foot should be planted during the animation clip, as well as how to blend out of the locked position.\n    This option also improves terrain adaptation for situations where the unadjusted foot position is above the terrain, since the solver can distinguish between when the foot should be planted and when the foot is actually supposed to be above the ground.\n    This option may still be used if no terrain object is specified."], "extent": [859, 1482]}, {"type": "para", "indent": 4, "text": ["The optional ", {"type": "code", "text": ["agentterrainadaptation_footdown"]}, " float array point attribute can be used to override the foot down values computed from the agent\u2019s animation clips.\n    The attribute is expected to contain a replacement foot down value for each entry in the ", {"type": "code", "text": ["agentrig_footchannels"]}, " point attribute.\n    This may be useful when applying terrain adaptation to cached agents."], "extent": [1482, 1858]}], "container": true, "attrs": {"id": "enablefootlocking"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Adjust Hips"], "extent": [1858, 1871], "body": [{"type": "para", "indent": 4, "text": ["When turned on, adjusts the position of the hips to ensure that the legs are not over-stretched when planting the feet on uneven terrain."], "extent": [1891, 2034]}], "container": true, "attrs": {"id": "adjusthips"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Hip Offset"], "extent": [2034, 2046], "body": [{"type": "para", "indent": 4, "text": ["Specifies an additional offset to shift the hips up or down."], "extent": [2065, 2131]}], "container": true, "attrs": {"id": "hipoffset"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Hip Shift Per Frame"], "extent": [2131, 2152], "body": [{"type": "para", "indent": 4, "text": ["When turned on, specifies how much the hips can be shifted by in a single frame. This can reduce sudden hip motion on uneven terrain."], "extent": [2178, 2317]}], "container": true, "attrs": {"id": "hipshiftperframe"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Knee Damping Threshold (%)"], "extent": [2317, 2345], "body": [{"type": "para", "indent": 4, "text": ["When the distance from the upper leg to the target ankle position is greater than this percentage of the maximum leg length, the knee angle will be damped so that it smoothly approaches a 180 degree angle as the target ankle position is extended.\n    This can prevent the knee from popping when the leg is almost fully extended."], "extent": [2375, 2709]}, {"type": "note_group", "body": [{"type": "note", "indent": 4, "role": "item", "extent": [2709, 2719], "body": [{"type": "para", "indent": 8, "text": ["This can allow the leg to stretch slightly, as keeping the foot planted on the terrain is a higher priority."], "extent": [2719, 2837]}], "container": true}], "container": true, "role": "item_group"}], "container": true, "attrs": {"id": "kneedampingthreshold"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Enable Terrain Adaptation"], "extent": [2837, 2864], "body": [{"type": "para", "indent": 4, "text": ["When turned on, adjusts the agents' legs to conform to the terrain."], "extent": [2897, 2970]}], "container": true, "attrs": {"id": "enableterrainadaptation"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Lean Angle Per Frame"], "extent": [2970, 2992], "body": [{"type": "para", "indent": 4, "text": ["When navigating uneven terrain, the agent can lean forward or backward. When turned on, this parameter specifies the maximum angle (in degrees) that the agent can tilt in a single frame."], "extent": [3011, 3203]}], "container": true, "attrs": {"id": "leanangle"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Backward Lean"], "extent": [3203, 3218], "body": [{"type": "para", "indent": 4, "text": ["Specifies how far (in degrees) the agent can lean backward."], "extent": [3240, 3305]}], "container": true, "attrs": {"id": "backwardlean"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Forward Lean"], "extent": [3305, 3319], "body": [{"type": "para", "indent": 4, "text": ["Specifies how far (in degrees) the agent can lean forward."], "extent": [3340, 3404]}], "container": true, "attrs": {"id": "forwardlean"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Reference Direction"], "extent": [3404, 3425], "body": [{"type": "para", "indent": 4, "text": ["The original facing direction of the agent. This is used along with the ", {"type": "ui", "text": ["Reference Up"]}, " vector to define the plane of the 2-bone IK adjustment for the legs."], "extent": [3425, 3588]}], "container": true, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Reference Up"], "extent": [3588, 3602], "body": [{"type": "para", "indent": 4, "text": ["The original up vector of the agent. This controls the direction of hip adjustment and foot planting."], "extent": [3602, 3709]}], "container": true, "role": "item"}], "container": true, "role": "item_group"}]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Guides"], "extent": [3709, 3722], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Show Guide Geometry"], "extent": [3722, 3744], "body": [{"type": "para", "indent": 4, "text": ["When turned on, displays guide geometry indicating the positions of the lower limb joints and whether the feet are locked."], "extent": [3763, 3891]}], "container": true, "attrs": {"id": "showguide"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Scale"], "extent": [3891, 3898], "body": [{"type": "para", "indent": 4, "text": ["Adjusts the size of the guide geometry."], "extent": [3918, 3963]}], "container": true, "attrs": {"id": "guidescale"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Locked Scale"], "extent": [3963, 3977], "body": [{"type": "para", "indent": 4, "text": ["Adjusts the ", {"type": "ui", "text": ["Scale"]}, " to indicate when the foot is locked."], "extent": [3998, 4062]}], "container": true, "attrs": {"id": "lockedscale"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Color"], "extent": [4062, 4069], "body": [{"type": "para", "indent": 4, "text": ["Specifies the color of the guide geometry.\n    When ", {"type": "ui", "text": ["Enable Foot Locking"]}, " is turned on, the color ramp indicates when the ankle and toe joints are locked or blending out of the locked position."], "extent": [4089, 4290]}], "container": true, "attrs": {"id": "guidecolor"}, "role": "item"}], "container": true, "role": "item_group"}]}], "text": "Parameters"}, {"level": 1, "id": "inputs", "container": true, "type": "inputs_section", "indent": 0, "role": "section", "extent": [4290, 4298], "body": [{"type": "dt_group", "body": [{"type": "dt", "indent": 0, "text": ["Agent"], "extent": [4298, 4306], "body": [{"type": "para", "indent": 4, "text": ["The packed primitive agent to modify."], "extent": [4306, 4349]}], "container": true}], "container": true}], "text": "Inputs"}, {"level": 1, "id": "outputs", "container": true, "type": "outputs_section", "indent": 0, "role": "section", "extent": [4349, 4358], "body": [{"type": "dt_group", "body": [{"type": "dt", "indent": 0, "text": ["Agent"], "extent": [4358, 4366], "body": [{"type": "para", "indent": 4, "text": ["The modified packed primitive agent with terrain adaptation applied."], "extent": [4366, 4440]}], "container": true}], "container": true}], "text": "Outputs"}, {"level": 1, "id": "related", "container": true, "type": "related_section", "indent": 0, "role": "section", "extent": [4440, 4449], "body": [{"type": "bullet_group", "body": [{"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/sop/agentprep", "type": "link", "text": "", "fullpath": "/nodes/sop/agentprep.html"}], "extent": [4449, 4472]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/dop/agentterrainprojection", "type": "link", "text": "", "fullpath": "/nodes/dop/agentterrainprojection.html"}], "extent": [4472, 4508]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/dop/crowdsolver", "type": "link", "text": "", "fullpath": "/nodes/dop/crowdsolver.html"}], "extent": [4508, 4533]}], "container": true}], "text": "Related"}], "title": ["Agent Terrain Adaptation"], "summary": ["Adapts the legs of an agent to conform to terrain and prevent the feet from sliding."], "included": ["/nodes/dop/agentterrainprojection"]}