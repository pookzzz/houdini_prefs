{"type": "root", "attrs": {"type": "node", "context": "dop", "icon": "SOP/mpmsolver", "internal": "mpmsolver", "tags": "MPM", "version": "1.0", "since": "20.5", "namespace": null}, "body": [{"level": 0, "type": "title", "indent": 0, "text": ["MPM Solver"], "extent": [107, 122]}, {"type": "summary", "indent": 0, "text": ["Solves the MPM simulation described by its inputs and parameters."], "extent": [122, 196]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Overview"], "extent": [196, 211], "body": [{"type": "para", "indent": 0, "text": ["This node represents the DOP backend of the ", {"scheme": "Node", "value": "/nodes/sop/mpmsolver", "type": "link", "text": ["MPM Solver"], "fullpath": "/nodes/sop/mpmsolver.html"}, "."], "extent": [211, 290]}]}, {"level": 1, "id": "inputs", "container": true, "type": "inputs_section", "indent": 0, "role": "section", "extent": [290, 298], "body": [{"type": "dt_group", "body": [{"type": "dt", "indent": 0, "text": ["Objects to Solve"], "extent": [298, 317], "body": [{"type": "para", "indent": 4, "text": ["Expects an ", {"scheme": "Node", "value": "/nodes/dop/mpmobject", "type": "link", "text": ["MPM Object"], "fullpath": "/nodes/dop/mpmobject.html"}, "."], "extent": [317, 366]}], "container": true}, {"type": "dt", "indent": 0, "text": ["Particles Forces"], "extent": [366, 384], "body": [{"type": "para", "indent": 4, "text": ["Expects forces and other DOP customizations from the user."], "extent": [384, 448]}], "container": true}], "container": true}], "text": "Inputs"}, {"level": 1, "id": "parameters", "container": true, "type": "parameters_section", "indent": 0, "role": "section", "extent": [448, 460], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Time Scale"], "extent": [1889, 1902], "body": [{"type": "para", "indent": 4, "text": ["Multiplier applied to the timestep used by the solver."], "extent": [1921, 1985]}], "container": true, "attrs": {"id": "timescale"}, "role": "item"}], "container": true, "role": "item_group"}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Iterations"], "extent": [507, 524], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["CFL Condition"], "extent": [2208, 2223], "body": [{"type": "para", "indent": 4, "text": ["The fraction of voxel width that a particle is allowed to travel within a single timestep."], "extent": [2245, 2345]}], "container": true, "attrs": {"id": "cflcondition"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Material Condition"], "extent": [2345, 2365], "body": [{"type": "para", "indent": 4, "text": ["A multiplier on the maximum timestep allowed based on the simulated material properties. To maintain the integrity of stiff materials, impulses need to travel very fast through the material. This imposes a constraint on the maximum allowed timestep similar to the ", {"type": "ui", "text": ["CFL Condition"]}, ". Increasing this value or reducing the stiffness of the simulated materials will relax this constraint and could speed up the simulation."], "extent": [2392, 2821]}], "container": true, "attrs": {"id": "materialcondition"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Substeps Min/Max"], "extent": [2821, 2839], "body": [{"type": "para", "indent": 4, "text": ["Limits on the minimum and maximum number of substeps."], "extent": [2861, 2924]}, {"type": "para", "indent": 4, "text": ["The solver dynamically picks the lowest substep count based on the type and speed of the material. Although the max value is set at 10,000 by default, it doesn\u2019t mean 10,000 are necessarily being used. You can see the actual substep count on the outputted geometry as a detail attribute. The high default value is to account for stiffer materials, like concrete or metal, that will require more substeps and are expected to be slow."], "extent": [2924, 3362]}, {"type": "tip_group", "body": [{"type": "tip", "indent": 4, "role": "item", "extent": [3362, 3371], "body": [{"type": "para", "indent": 8, "text": ["When facing instability, it is recommended to look at the ", {"scheme": "Node", "value": "/nodes/sop/mpmsolver", "type": "link", "text": ["MPM Solver"], "fullpath": "/nodes/sop/mpmsolver.html"}, "'s detail attributes to find the number substeps actually being computed on each frame. Using this information, it is often easy to raise the minimum substeps or reduce the ", {"type": "ui", "text": ["CFL"]}, " / ", {"type": "ui", "text": ["Material Condition"]}, " to prevent it from dipping below a certain number which will often solve the issue."], "extent": [3371, 3759]}], "container": true}], "container": true, "role": "item_group"}, {"type": "note_group", "body": [{"type": "note", "indent": 4, "role": "item", "extent": [3759, 3769], "body": [{"type": "para", "indent": 8, "text": ["Both the ", {"type": "ui", "text": ["CFL"]}, " and ", {"type": "ui", "text": ["Material Conditions"]}, " impose their own independent constraint on the maximum timestep allowed. The most strict constraint will drive the timestep while the more permissive one will have little impact. This means that, when simulating very stiff materials (bounded by the ", {"type": "ui", "text": ["Material Condition"]}, " like metal or concrete), objects will be allowed to move relatively fast without noticeable changes on the number of substeps required by the ", {"type": "ui", "text": ["CFL Condition"]}, ". "], "extent": [3769, 4261]}], "container": true}], "container": true, "role": "item_group"}], "container": true, "attrs": {"id": "substeprange"}, "role": "item"}], "container": true, "role": "item_group"}]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Forces"], "extent": [667, 680], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Gravity"], "extent": [4276, 4286], "body": [{"type": "para", "indent": 4, "text": ["The gravity acceleration."], "extent": [4303, 4338]}], "container": true, "attrs": {"id": "gravity"}, "role": "item"}], "container": true, "role": "item_group"}]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Ground Plane"], "extent": [725, 744], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Enable"], "extent": [4551, 4560], "body": [{"type": "para", "indent": 4, "text": ["Creates a ground plane."], "extent": [4582, 4615]}], "container": true, "attrs": {"id": "groundactive"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Response"], "extent": [4615, 4625], "body": [{"type": "para", "indent": 4, "text": ["Defines how the ground plane should affect the material on contact."], "extent": [4649, 4726]}, {"type": "dt_group", "body": [{"type": "dt", "indent": 4, "text": ["Bounce"], "extent": [4726, 4738], "body": [{"type": "para", "indent": 8, "text": ["Bounce or stop the material depending on its constitutive model."], "extent": [4738, 4820]}], "container": true}, {"type": "dt", "indent": 4, "text": ["Delete"], "extent": [4820, 4832], "body": [{"type": "para", "indent": 8, "text": ["Delete material points."], "extent": [4832, 4873]}], "container": true}], "container": true}], "container": true, "attrs": {"id": "groundresponse"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Position"], "extent": [4873, 4883], "body": [{"type": "para", "indent": 4, "text": ["Location of the ground plane in space."], "extent": [4902, 4950]}], "container": true, "attrs": {"id": "groundpos"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Up Direction"], "extent": [4950, 4964], "body": [{"type": "para", "indent": 4, "text": ["Normal vector or orientation of the ground plane."], "extent": [4982, 5041]}], "container": true, "attrs": {"id": "groundup"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Friction"], "extent": [5264, 5274], "body": [{"type": "para", "indent": 4, "text": ["Amount of friction applied from the ground plane to the material, when in contact."], "extent": [5298, 5390]}], "container": true, "attrs": {"id": "groundfriction"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Sticky"], "extent": [5390, 5398], "body": [{"type": "para", "indent": 4, "text": ["Allows projection of the material velocity even when moving away from the ground plane. This prevents the material from detaching from the ground plane, making it sticky if friction is high enough. If the dot product between the normal vector of the ground plane and the velocity of the material is smaller than this value, the velocity of the material gets projected onto the ground plane."], "extent": [5420, 5820]}], "container": true, "attrs": {"id": "groundsticky"}, "role": "item"}], "container": true, "role": "item_group"}]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["OpenCL"], "extent": [1011, 1024], "body": [{"type": "include_group", "body": [{"ext": "opencl#finish/", "type": "include", "indent": 0, "role": "item", "extent": [1024, 1050]}, {"ext": "opencl#recompile/", "type": "include", "indent": 0, "role": "item", "extent": [1050, 1078]}, {"ext": "opencl#kerneloptions/", "type": "include", "indent": 0, "role": "item", "extent": [1078, 1115]}], "container": true, "role": "item_group"}]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Advanced"], "extent": [1115, 1130], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Rebuild Background Grids with OpenCL"], "extent": [5959, 5997], "body": [{"type": "para", "indent": 4, "text": ["Rebuild the VDB sparse background grids on the OpenCL device (GPU) instead of the host (CPU). This feature is turned off by default because of its high memory consumption which imposes a rather restrictive upper bound on the maximum resolution that can be simulated on a standard GPU."], "extent": [6021, 6315]}], "container": true, "attrs": {"id": "gpugridrebuild"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Assume Unchanging Material Properties"], "extent": [6315, 6354], "body": [{"type": "para", "indent": 4, "text": ["Assumes that the material properties are constant throughout the simulation. This is an optimization that prevents the solver from recomputing the ", {"type": "ui", "text": ["Material Condition"]}, " on every frame. This should be turned off if different materials are sourced on different frames or if the dive target inside the solver is dynamically modifying the material properties as the simulation runs. Turning this off will slow down the simulation but will ensure stability by keeping the ", {"type": "ui", "text": ["Material Condition"]}, " consistent."], "extent": [6379, 6891]}], "container": true, "attrs": {"id": "staticmaterials"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Enable Particle-Level Collisions"], "extent": [6891, 6925], "body": [{"type": "para", "indent": 4, "text": ["Allows a second collision step to be performed directly on the material points. This adds some computation but yields more accurate collisions. In general, this can be turned off unless very precise collisions are required such as with thin colliders."], "extent": [6958, 7219]}], "container": true, "attrs": {"id": "particlelevelcollisions"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Move Outside Colliders"], "extent": [7219, 7243], "body": [{"type": "para", "indent": 4, "text": ["Specifies how particles sinking into colliders should be treated."], "extent": [7273, 7348]}, {"type": "dt_group", "body": [{"type": "dt", "indent": 4, "text": ["Don\u2019t Move Outside Colliders"], "extent": [7348, 7382], "body": [{"type": "para", "indent": 8, "text": ["Only apply the collision response to the particles' velocity. While more accurate, this won\u2019t prevent particles from sinking into the colliders."], "extent": [7382, 7544]}], "container": true}, {"type": "dt", "indent": 4, "text": ["Position-Based Move Outside Colliders"], "extent": [7544, 7587], "body": [{"type": "para", "indent": 8, "text": ["Apply the collision response to the particles' velocity and move them out of the colliders acting on position directly. This can lead to a loss of volume."], "extent": [7587, 7759]}], "container": true}, {"type": "dt", "indent": 4, "text": ["Velocity-Based Move Outside Colliders"], "extent": [7759, 7802], "body": [{"type": "para", "indent": 8, "text": ["Apply the collision response to the particles' velocity and further adjust the velocity such that the particles are moved outside of the colliders during the next integration step. This is the most accurate way to make sure particles do not sink inside the collider but can lead to instability."], "extent": [7802, 8119]}], "container": true}], "container": true}], "container": true, "attrs": {"id": "moveoutsidecolliders"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Enable Affine Velocity (C) Clamping"], "extent": [8119, 8156], "body": [{"type": "para", "indent": 4, "text": ["Limits the magnitude of the ", {"type": "ui", "text": ["Affine Velocity"]}, " matrix ", {"type": "code", "text": ["C"]}, "'s determinant. This prevents ", {"type": "code", "text": ["C"]}, " from becoming unreasonably large which often leads to ", {"type": "code", "text": ["inf"]}, " and ", {"type": "code", "text": ["nan"]}, " velocities. Instability should always be resolved with more substeps or by modifying the material properties, but this parameter can prevent some issues without affecting the amount of energy in the simulation."], "extent": [8175, 8562]}], "container": true, "attrs": {"id": "cclamping"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Min/Max Voxel Dilation"], "extent": [8562, 8586], "body": [{"type": "para", "indent": 4, "text": ["Imposes constraints on the dilation of the sparse background grid in terms of voxel. The sparse background grid is only rebuilt every DOP substep (once per frame by default). To make sure material points do not land in inactive regions of the grid, it is being dilated to account for the motion that takes place between two consecutive DOP substeps."], "extent": [8614, 8969]}, {"type": "tip_group", "body": [{"type": "tip", "indent": 4, "role": "item", "extent": [8969, 8978], "body": [{"type": "para", "indent": 8, "text": ["Particles trying to move outside of the activated regions will be stopped at the boundary. Increasing the maximum dilation will solve this issue."], "extent": [8978, 9133]}], "container": true}], "container": true, "role": "item_group"}, {"type": "note_group", "body": [{"type": "note", "indent": 4, "role": "item", "extent": [9133, 9143], "body": [{"type": "para", "indent": 8, "text": ["Keep in mind that the dilation is defined in terms of voxels and not world units. Doubling the resolution of the simulation will effectively reduce by half the minimum and maximum padding in world units."], "extent": [9143, 9360]}], "container": true}], "container": true, "role": "item_group"}], "container": true, "attrs": {"id": "minmaxvoxelpadding"}, "role": "item"}], "container": true, "role": "item_group"}]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Geometry"], "extent": [1427, 1442], "body": [{"type": "parameters_item_group", "body": [{"type": "parameters_item", "indent": 0, "text": ["Pinned Animation"], "extent": [1442, 1461], "body": [{"type": "para", "indent": 4, "text": ["SOP geometry containing animation data in the case of pin-to-animation points."], "extent": [1486, 1574]}], "container": true, "attrs": {"id": "pinanimationgeo"}, "role": "item"}, {"type": "parameters_item", "indent": 0, "text": ["Container"], "extent": [1574, 1585], "body": [{"type": "para", "indent": 4, "text": ["SOP geometry of the simulation domain/container."], "extent": [1607, 1665]}], "container": true, "attrs": {"id": "containergeo"}, "role": "item"}], "container": true, "role": "item_group"}]}], "text": "Parameters"}, {"level": 1, "id": "related", "container": true, "type": "related_section", "indent": 0, "role": "section", "extent": [1665, 1674], "body": [{"type": "bullet_group", "body": [{"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/dop/mpmobject", "type": "link", "text": ["MPM Object"], "fullpath": "/nodes/dop/mpmobject.html"}], "extent": [1674, 1708]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": [{"scheme": "Node", "value": "/nodes/sop/mpmsolver", "type": "link", "text": ["MPM Solver"], "fullpath": "/nodes/sop/mpmsolver.html"}], "extent": [1708, 1743]}], "container": true}], "text": "Related"}], "title": ["MPM Solver"], "summary": ["Solves the MPM simulation described by its inputs and parameters."], "included": ["/nodes/sop/mpmsolver", "/nodes/sop/opencl"]}