{"type": "root", "attrs": {}, "body": [{"level": 0, "type": "title", "indent": 0, "text": ["Cryptomatte"], "extent": [0, 16]}, {"type": "summary", "indent": 0, "text": ["How to generate image maps associating each pixel in the image with the object name and/or material in the original source scene."], "extent": [16, 155]}, {"level": 2, "id": "oview", "container": true, "type": "h", "indent": 0, "text": ["Overview"], "extent": [155, 178], "body": [{"type": "para", "indent": 0, "text": ["Cryptomatte is ", {"scheme": null, "value": "https://github.com/Psyop/Cryptomatte", "type": "link", "text": ["a set of open-source tools"], "exists": true}, " for generating and working with images that associate individual pixels with object IDs. More generally, a ", {"type": "q", "text": ["cryptomatte"]}, " is the type of image generated by the tools, or equivalent features in other software such as Houdini. This is a deep EXR image which stores object names/materials per-pixel, with special filtering to properly support anti-aliasing and transparency."], "extent": [178, 632]}, {"type": "para", "indent": 0, "text": ["You can use the image to mask compositing effects to only the pixels associated with certain 3D source objects, or certain materials, without having to re-render the scene."], "extent": [632, 806]}, {"type": "para", "indent": 0, "text": [{"scheme": "Image", "value": "/images/render/cryptomatte_example.jpg", "type": "img", "text": ""}], "extent": [806, 854]}, {"type": "para", "indent": 0, "text": ["The following example shows how you can use a cryptomatte image to isolate a specific material in a Houdini compositor network."], "extent": [854, 983]}, {"type": "para", "indent": 0, "text": [{"scheme": "Image", "value": "/images/render/crypto_example.jpg", "type": "img", "text": ""}], "extent": [983, 1026]}, {"type": "para", "indent": 0, "text": ["See Cryptomatte\u2019s ", {"scheme": null, "value": "https://github.com/Psyop/Cryptomatte", "type": "link", "text": ["official site"], "exists": true}, " for specifications and plugins for popular compositing applications."], "extent": [1026, 1167]}, {"type": "note_group", "body": [{"type": "note", "indent": 0, "role": "item", "extent": [1167, 1173], "body": [{"type": "para", "indent": 4, "text": ["Cryptomatte is supported by Karma CPU and Karma XPU."], "extent": [1173, 1231]}], "container": true}], "container": true, "role": "item_group"}]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["Tips and notes"], "extent": [1231, 1252], "body": [{"type": "bullet_group", "body": [{"blevel": 2, "type": "bullet", "indent": 0, "text": ["You can generate a cryptomatte from object names, or materials, or the values of a custom string primvar."], "extent": [1252, 1362]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": ["In USD/Karma rendering, ", {"type": "q", "text": ["object name"]}, " is the ", {"type": "strong", "text": ["full path"]}, " of the geometry prim. For example, for a prim at ", {"type": "code", "text": ["/Models/lamp/base1"]}, " the ", {"type": "q", "text": ["object name"]}, " would be ", {"type": "code", "text": ["/Models/lamp/base1"]}, "."], "extent": [1362, 1541]}, {"blevel": 2, "type": "bullet", "indent": 0, "text": ["You can generate a cryptomatte AOV using one method (for example object names), ", {"type": "em", "text": ["and"]}, " a separate cryptomatte AOV using another method (for example materials), to allow you to mask by both/either."], "extent": [1541, 1741]}], "container": true}]}, {"level": 2, "id": null, "container": true, "type": "h", "indent": 0, "text": ["How to"], "extent": [1741, 1754], "body": [{"type": "task_group", "body": [{"ext": null, "type": "task", "indent": 0, "text": [" Render a traditional Houdini object-level scene to a cryptomatte using Mantra"], "role": "item", "extent": [1754, 1842], "body": [{"type": "para", "indent": 4, "text": ["See ", {"scheme": null, "value": "/render/cryptomatte", "type": "link", "text": ["Cryptomatte in Mantra"], "fullpath": "/render/cryptomatte.html"}, "."], "extent": [1842, 1896]}], "container": true}, {"ext": null, "type": "task", "indent": 0, "text": [" Render a USD scene to a cryptomatte image using Karma"], "role": "item", "extent": [1896, 1959], "body": [{"type": "para", "indent": 4, "text": ["Karma generates the cryptmatte layer as an extra image plane (AOV) in the main rendered image."], "extent": [1959, 2059]}, {"type": "ord_group", "body": [{"blevel": 6, "type": "ord", "indent": 4, "text": ["Set up the ", {"scheme": "Node", "value": "/nodes/out/karma", "type": "link", "text": ["Karma ROP"], "fullpath": "/nodes/out/karma.html"}, " you want to use to render the scene."], "extent": [2059, 2141]}, {"blevel": 6, "type": "ord", "indent": 4, "text": ["Click the ", {"type": "ui", "text": ["Image Output"]}, " tab and then the ", {"type": "ui", "text": ["AOVs"]}, " sub-tab."], "extent": [2141, 2210]}, {"blevel": 6, "type": "ord", "indent": 4, "text": ["Scroll down and click ", {"type": "ui", "text": ["Extra Render Vars"]}, " to show that section."], "extent": [2210, 2283]}, {"blevel": 6, "type": "ord", "indent": 4, "text": ["Next to ", {"type": "ui", "text": ["Render Vars"]}, ", click the Plus button to add a new image plane."], "extent": [2283, 2363]}, {"blevel": 6, "type": "ord", "indent": 4, "text": ["Next to the ", {"type": "ui", "text": ["Name"]}, " field, click the drop-down menu and choose ", {"type": "ui", "text": ["Cryptomatte Object Name"]}, " or ", {"type": "ui", "text": ["Cryptomatte Material Name"]}, " to fill in the correct settings for the render var."], "extent": [2363, 2547], "body": [{"type": "para", "indent": 8, "text": [{"type": "em", "text": ["or"]}], "extent": [2547, 2561]}, {"type": "para", "indent": 8, "text": ["If you have a ", {"type": "q", "text": ["uniform"]}, " or ", {"type": "q", "text": ["constant"]}, " primvar of type ", {"type": "code", "text": ["string"]}, " on the object, you can enter the name of the primvar ", {"type": "ui", "text": ["Source Name"]}, " parameter to generate IDs from the primvar values."], "extent": [2561, 2753]}], "container": true}], "container": true}], "container": true}, {"ext": null, "type": "task", "indent": 0, "text": [" Generate masks in the compositor from a cryptomatte"], "role": "item", "extent": [2753, 2814], "body": [{"type": "para", "indent": 4, "text": ["See the help for the ", {"scheme": null, "value": "/nodes/cop2/cryptomatte", "type": "link", "text": ["Cryptomatte COP"], "fullpath": "/nodes/cop2/cryptomatte.html"}, "."], "extent": [2814, 2884]}], "container": true}], "container": true, "role": "item_group"}]}], "title": ["Cryptomatte"], "summary": ["How to generate image maps associating each pixel in the image with the object name and/or material in the original source scene."]}